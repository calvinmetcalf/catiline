/*! catiline 2.9.3 2015-01-30*/
/*!(c)2013 Calvin Metcalf @license MIT https://github.com/calvinmetcalf/catiline */
/*!Includes Promiscuous (c)2013 Ruben Verborgh @license MIT https://github.com/RubenVerborgh/promiscuous*/
/*!Includes Material from setImmediate Copyright (c) 2012 Barnesandnoble.com, llc, Donavon West, and Domenic Denicola @license MIT https://github.com/NobleJS/setImmediate */
"undefined"==typeof document?(self._noTransferable=!0,self.onmessage=function(e){eval(e.data)}):!function(a){"use strict";function Deferred(){function Promise(){this.then=function(b,c){return a(b,c)}}var a=function(f,g,h){if(f!==a){var i=b();return a.queue.push({deferred:i,resolve:f,reject:g}),i.promise}for(var j=g?"resolve":"reject",k=0,l=a.queue.length;l>k;k++){var m=a.queue[k],n=m.deferred,o=m[j];typeof o!==x?n[j](h):d(o,h,n)}a=c(e,h,g)},e=new Promise;this.promise=e,a.queue=[],this.resolve=function(b){a.queue&&a(a,!0,b)},this.fulfill=this.resolve,this.reject=function(b){a.queue&&a(a,!1,b)}}function b(){return new Deferred}function c(a,c,e){return function(f,g){var h=e?f:g;if(typeof h!==x)return a;var i=b();return d(h,c,i),i.promise}}function d(a,b,c){v.nextTick(function(){try{var d=a(b);d&&typeof d.then===x?d.then(c.resolve,c.reject):c.resolve(d)}catch(e){c.reject(e)}})}function e(a){for(var b=a,c=!0,d={},e=function(a,b){b&&"importScripts("+b.split(",").forEach(function(a){d[v.makeUrl(a.match(/\s*[\'\"](\S*)[\'\"]\s*/)[1])]=!0})+");\n"};c;)c=b.match(/(importScripts\(.*?\);?)/),b=b.replace(/(importScripts\(\s*(?:[\'\"].*?[\'\"])?\s*\);?)/,"\n"),c&&c[0].replace(/importScripts\(\s*([\'\"].*?[\'\"])?\s*\);?/g,e);return d=Object.keys(d),[d,b]}function f(a,b){var c=e(a),d=c[0],f=c[1];return d.length>0?"importScripts('"+d.join("','")+b+f:f}function g(){if("undefined"!=typeof SHIM_WORKER_PATH)return SHIM_WORKER_PATH;if("SHIM_WORKER_PATH"in v)return v.SHIM_WORKER_PATH;for(var a=document.getElementsByTagName("script"),b=a.length,c=0;b>c;){if(/catiline(\.min)?\.js/.test(a[c].src))return a[c].src;c++}}function h(a,b){var c=a.createElement("script");"undefined"!=typeof c.text?c.text=b:c.innerHTML=b,"complete"===a.readyState?a.documentElement.appendChild(c):a.onreadystatechange=function(){"complete"===a.readyState&&a.documentElement.appendChild(c)}}function i(a,b){var c=document.createElement("iframe");c.style.display="none",document.body.appendChild(c);var d=c.contentWindow.document,e=["try{ ","var __scripts__='';function importScripts(scripts){","	if(Array.isArray(scripts)&&scripts.length>0){","		scripts.forEach(function(url){","			var ajax = new XMLHttpRequest();","			ajax.open('GET',url,false);","			ajax.send();__scripts__+=ajax.responseText;","			__scripts__+='\\n;';","		});","	}","};",a,"}catch(e){","	window.parent.postMessage(['"+b+"','error'],'*')","}"].join("\n");return h(d,e),c}function j(a,b){var c=v.deferred();return"complete"===document.readyState?c.resolve(i(a,b)):window.addEventListener("load",function(){c.resolve(i(a,b))},!1),c.promise}function k(a){v._noTransferable=!0;var b=new Worker(g());return b.postMessage(a),b}function l(a){var b="{",c=!0;for(var d in a)c?c=!1:b+=",",b+=d,b+=":",b+=v.stringify(a[d]);return b+="}"}function m(a){if(a.length){var b="[";b+=v.stringify(a[0]);for(var c=0,d=a.length;++c<d;)b+=",",b+=v.stringify(a[c]);return b+="]"}return"[]"}function n(a,b){var c,d={};"undefined"!=typeof __self__?c=__self__.postMessage:b&&(c=b),a.on=function(b,c,e){if(e=e||a,b.indexOf(" ")>0)return b.split(" ").map(function(b){return a.on(b,c,e)},this),a;b in d||(d[b]=[]);var f=function(a){c.call(e,a,e)};return f.orig=c,d[b].push(f),a},a.one=function(b,c,d){function e(f){a.off(b,e),c.call(d,f,d)}return d=d||a,a.on(b,e)},a.trigger=function(b,c){return b.indexOf(" ")>0?(b.split(" ").forEach(function(b){a.trigger(b,c)}),a):b in d?(d[b].forEach(function(a){a(c)}),a):a},a.fire=function(b,d,e){return c([[b],d],e),a},a.off=function(b,c){return b.indexOf(" ")>0?(b.split(" ").map(function(b){return a.off(b,c)}),a):b in d?(c?d[b]=d[b].map(function(a){return a.orig===c?!1:a}).filter(function(a){return a}):delete d[b],a):a}}function o(a){if("undefined"!=typeof console){var b=console[a[0]]?a[0]:"log";"undefined"==typeof console[b].apply?console[b](a[1].join(" ")):console[b].apply(console,a[1])}}function p(a){function b(b){return function(){for(var c=arguments.length,d=[],e=0;c>e;)d.push(arguments[e]),e++;a.fire("console",[b,d])}}["log","debug","error","info","warn","time","timeEnd"].forEach(function(a){console[a]=b(a)})}function Catiline(a){"function"==typeof a&&(a={data:a});var b="com.catilinejs."+(Catiline._hasWorker?"iframe":"worker")+Math.random(),c=this,d=[];n(c,function(a,b){v._noTransferable?l.postMessage(a):l.postMessage(a,b)});var e=function(a){"string"!=typeof a&&"preventDefault"in a&&(a.preventDefault(),a=a.message),d.forEach(function(b){b&&b.reject(a)})};if(a.__codeWord__=b,a.__initialize__=[y,n,p],"initialize"in a?a.__initialize__.push(a.initialize):"init"in a&&a.__initialize__.push(a.init),"events"in a||(a.events={}),"listners"in a&&"function"!=typeof a.listners)for(var f in a.listners)c.on(f,a.listners[f]);var g="var _db = {\n	",h=function(a){var c=function(c,e){var f=d.length;return d[f]=v.deferred(),v._noTransferable?l.postMessage([[b,f],a,c]):l.postMessage([[b,f],a,c],e),d[f].promise};return c},i=!1;for(var j in a)if(!(["listners","initialize","init"].indexOf(j)>-1))if(i?g+=",\n	":i=!0,"function"==typeof a[j])g=g+j+":"+a[j].toString(),c[j]=h(j);else{var k=v.stringify(a[j]);"undefined"!=typeof k&&(g=g+j+":"+k)}g+="};";var l=v.makeWorker(["'use strict';","",g,"_db.__initialize__.forEach(function(f){","	f.call(_db,_db);","});","for(var key in _db.events){","	_db.on(key,_db.events[key]);","}"],b);l.onmessage=function(a){c.trigger("message",a.data[1]),a.data[0][0]===b?(d[a.data[0][1]].resolve(a.data[1]),d[a.data[0][1]]=0):c.trigger(a.data[0][0],a.data[1])},c.on("error",e),l.onerror=function(a){c.trigger("error",a)},c.on("console",o),c._close=function(){return l.terminate(),e("closed"),v.resolve()},"close"in c||(c.close=c._close)}function q(a,b){return{keyFunc:function(b){return function(c,d){return a(b,c,d)}},keyFuncBatch:function(b){return function(c){return v.all(c.map(function(c){return a(b,c)}))}},keyFuncBatchCB:function(c){return function(d){return v.all(d.map(function(d){return a(c,d).then(b.__cb__)}))}},keyFuncBatchTransfer:function(b){return function(c){return v.all(c.map(function(c){return a(b,c[0],c[1])}))}},keyFuncBatchTransferCB:function(c){return function(d){return v.all(d.map(function(d){return a(c,d[0],d[1]).then(b.__cb__)}))}}}}function r(a,b,c){var d=q(a,b);for(var e in c)b[e]=d.keyFunc(e),b.batch[e]=d.keyFuncBatch(e),b.__batchcb__[e]=d.keyFuncBatchCB(e),b.batchTransfer[e]=d.keyFuncBatchTransfer(e),b.__batchtcb__[e]=d.keyFuncBatchTransferCB(e)}function s(a,b,c){a.on=function(c,d,e){return b.forEach(function(a){a.on(c,d,e)}),a},a.off=function(c,d,e){return b.forEach(function(a){a.off(c,d,e)}),a},a.fire=function(d,e){return b[~~(Math.random()*c)].fire(d,e),a}}function t(a,b){return function(c,d,e,f){return f.promise.cancel=function(a){return f.reject(a)},a[~~(Math.random()*b)][c](d,e).then(function(a){return f.resolve(a)},function(a){return f.reject(a)}),f.promise}}function u(a,b,c){for(var d=[],e=-1;++e<a;)d[e]=new v.Worker(c),b.push(e);return d}function CatilineQueue(a,b,c){function d(a){a=a||"canceled",k=0;var b=j;return j=[],b.forEach(function(b){b[3].reject(a)}),g}function e(a){if(k){var b=j.shift();k--,l[a][b[0]](b[1],b[2]).then(function(c){e(a),b[3].resolve(c)},function(c){e(a),b[3].reject(c)})}else h++,i.push(a)}function f(a,b,d){var f=v.deferred();if(c)return n(a,b,d,f);if(!k&&h){var g=i.pop();h--,f.promise.cancel=function(a){return f.reject(a)},l[g][a](b,d).then(function(a){e(g),f.resolve(a)},function(a){e(g),f.reject(a)})}else if(k||!h){var m=[a,b,d,f];f.promise.cancel=function(a){var b=j.indexOf(m);return b>-1&&(j.splice(b,1),k--),f.reject(a)},k=j.push(m)}return f.promise}var g=this,h=b,i=[],j=[],k=0,l=u(b,i,a);s(g,l,b);var m=function(a,b){return l.forEach(function(c){c.fire(a,b)}),g};g.batch.fire=m,g.batchTransfer.fire=m,g.clearQueue=d,r(f,g,a);var n;c&&(n=t(l,b)),g._close=function(){return v.all(l.map(function(a){return a._close()}))},"close"in g||(g.close=g._close)}function v(a,b,c){return 1===arguments.length||!b||1>=b?new v.Worker(a):new v.Queue(a,b,c)}function w(b){var c=a.cw;b.noConflict=function(d){a.cw=c,d&&(a[d]=b)},a.catiline=b,a.cw=b,"communist"in a||(a.communist=b)}!function z(a,b,c){function d(f,g){if(!b[f]){if(!a[f]){var h="function"==typeof require&&require;if(!g&&h)return h(f,!0);if(e)return e(f,!0);var i=new Error("Cannot find module '"+f+"'");throw i.code="MODULE_NOT_FOUND",i}var j=b[f]={exports:{}};a[f][0].call(j.exports,function(b){var c=a[f][1][b];return d(c?c:b)},j,j.exports,z,a,b,c)}return b[f].exports}for(var e="function"==typeof require&&require,f=0;f<c.length;f++)d(c[f]);return d}({1:[function(a,b){function c(){e=!0;for(var a,b,c=h.length;c;){for(b=h,h=[],a=-1;++a<c;)b[a]();c=h.length}e=!1}function d(a){1!==h.push(a)||e||f()}for(var e,f,g=[a("./nextTick"),a("./mutation.js"),a("./messageChannel"),a("./stateChange"),a("./timeout")],h=[],i=-1,j=g.length;++i<j;)if(g[i]&&g[i].test&&g[i].test()){f=g[i].install(c);break}b.exports=d},{"./messageChannel":2,"./mutation.js":3,"./nextTick":7,"./stateChange":4,"./timeout":5}],2:[function(b,c,d){(function(a){d.test=function(){return a.setImmediate?!1:"undefined"!=typeof a.MessageChannel},d.install=function(b){var c=new a.MessageChannel;return c.port1.onmessage=b,function(){c.port2.postMessage(0)}}}).call(this,"undefined"!=typeof a?a:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(b,c,d){(function(a){var b=a.MutationObserver||a.WebKitMutationObserver;d.test=function(){return b},d.install=function(c){var d=0,e=new b(c),f=a.document.createTextNode("");return e.observe(f,{characterData:!0}),function(){f.data=d=++d%2}}}).call(this,"undefined"!=typeof a?a:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(b,c,d){(function(a){d.test=function(){return"document"in a&&"onreadystatechange"in a.document.createElement("script")},d.install=function(b){return function(){var c=a.document.createElement("script");return c.onreadystatechange=function(){b(),c.onreadystatechange=null,c.parentNode.removeChild(c),c=null},a.document.documentElement.appendChild(c),b}}}).call(this,"undefined"!=typeof a?a:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(a,b,c){c.test=function(){return!0},c.install=function(a){return function(){setTimeout(a,0)}}},{}],6:[function(a){v.nextTick=a("immediate")},{immediate:1}],7:[function(){},{}]},{},[6]);var x="function";v.deferred=b,v.resolve=function(a){var b={};return b.then=c(b,a,!0),b},v.reject=function(a){var b={};return b.then=c(b,a,!1),b},v.all=function(a){var c=b(),d=a.length,e=0,f=[],g=function(a){return function(b){f[a]=b,e++,e===d&&c.resolve(f)}};return a.forEach(function(a,b){a.then(g(b),function(a){c.reject(a)})}),c.promise},v._hasWorker="undefined"!=typeof Worker&&"undefined"==typeof fakeLegacy,v.URL=window.URL||window.webkitURL,v._noTransferable=!v.URL,v.makeIWorker=function(a,b){var c=f(a.join(""),"');eval(__scripts__);\n"),d={onmessage:function(){}},e=j(c,b);return window.addEventListener("message",function(a){a.data.slice&&a.data.slice(0,b.length)===b&&d.onmessage({data:JSON.parse(a.data.slice(b.length))})}),d.postMessage=function(a){e.then(function(b){b.contentWindow.postMessage(JSON.stringify(a),"*")})},d.terminate=function(){e.then(function(a){document.body.removeChild(a)})},d},v.makeWorker=function(a,b){if(!v._hasWorker)return v.makeIWorker(a,b);var c,d=f(a.join("\n"),"');\n");if(v._noTransferable)return k(d);try{c=new Worker(v.URL.createObjectURL(new Blob([d],{type:"text/javascript"})))}catch(e){try{c=k(d)}catch(g){c=v.makeIWorker(a,b)}}finally{return c}},v.makeUrl=function(a){var b=document.createElement("link");return b.href=a,b.href},v.stringify=function(a){return Array.isArray(a)?m(a):"function"==typeof a||"number"==typeof a||"boolean"==typeof a?a.toString():"string"==typeof a?'"'+a+'"':"[object Object]"===a.toString()?l(a):void 0};var y=function(a){self.__iFrame__="undefined"!=typeof document,self.__self__={onmessage:function(c){return a.trigger("messege",c.data[1]),c.data[0][0]===a.__codeWord__?b(c):void a.trigger(c.data[0][0],c.data[1])}},__iFrame__?window.onmessage=function(a){"string"==typeof a.data&&(a={data:JSON.parse(a.data)}),__self__.onmessage(a)}:self.onmessage=__self__.onmessage,__self__.postMessage=function(b,c){if(self._noTransferable||__iFrame__)if(__iFrame__){var d=a.__codeWord__+JSON.stringify(b);window.parent.postMessage(d,"*")}else self._noTransferable&&self.postMessage(b);else self.postMessage(b,c)},self.console={};var b=function(b){var c,d=function(a,c){__self__.postMessage([b.data[0],a],c)};if(__iFrame__)try{c=a[b.data[1]](b.data[2],d,a)}catch(e){a.fire("error",JSON.stringify(e))}else c=a[b.data[1]](b.data[2],d,a);"undefined"!=typeof c&&d(c)}};v.Worker=Catiline,v.worker=function(a){return new Catiline(a)},CatilineQueue.prototype.__batchcb__={},CatilineQueue.prototype.__batchtcb__={},CatilineQueue.prototype.batch=function(a){return"function"==typeof a?(this.__cb__=a,this.__batchcb__):this.clearQueue(a)},CatilineQueue.prototype.batchTransfer=function(a){return"function"==typeof a?(this.__batchtcb__.__cb__=a,this.__batchtcb__):this.clearQueue(a)},v.Queue=CatilineQueue,v.queue=function(a,b,c){return new v.Queue(a,b,c)},v.setImmediate=v.nextTick,"function"==typeof define?define(function(a){return v.SHIM_WORKER_PATH=a.toUrl("./catiline.js"),v}):"undefined"!=typeof module&&"exports"in module?module.exports=v:w(v),v.version="2.9.3"}(this);